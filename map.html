<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recycling Centers - DropMyElectronic</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2e7d32; --primary-light: #4caf50; --primary-dark: #1b5e20;
            --secondary-color: #ff9800; --accent-color: #2196f3; --text-color: #333;
            --light-bg: #f5f5f5; --white: #ffffff; --card-bg: #ffffff;
            --shadow: 0 4px 6px rgba(0,0,0,0.1); --radius: 8px; --footer-bg: #1a1a1a;
            --footer-text: #ffffff; --hero-gradient: linear-gradient(135deg, var(--primary-light) 0%, var(--primary-color) 100%);
            --header-bg: #ffffff;
        }
        .dark-mode {
            --primary-color: #4caf50; --primary-light: #66bb6a; --primary-dark: #388e3c;
            --secondary-color: #ffb74d; --accent-color: #64b5f6; --text-color: #e0e0e0;
            --light-bg: #121212; --white: #1e1e1e; --card-bg: #2d2d2d;
            --shadow: 0 4px 6px rgba(0,0,0,0.3); --footer-bg: #0a0a0a; --footer-text: #e0e0e0;
            --hero-gradient: linear-gradient(135deg, #1b5e20 0%, #2e7d32 100%); --header-bg: #1e1e1e;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: var(--text-color); background-color: var(--light-bg); }
        a { text-decoration: none; color: inherit; }
        .container { width: 90%; max-width: 1200px; margin: 0 auto; padding: 0 15px; }
        .btn { display: inline-block; background-color: var(--primary-color); color: white; padding: 8px 16px; border-radius: 4px; font-weight: 600; transition: all 0.3s ease; border: none; cursor: pointer; text-align: center; font-size: 0.9rem; }
        .btn:hover { background-color: var(--primary-dark); transform: translateY(-2px); }
        .btn-secondary { background-color: var(--secondary-color); }
        .btn-secondary:hover { background-color: #e68900; }
        section { padding: 60px 0; }
        h1, h2, h3, h4 { margin-bottom: 1rem; line-height: 1.2; }
        header { background-color: var(--header-bg); box-shadow: var(--shadow); position: sticky; top: 0; z-index: 100; }
        .header-container { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; }
        .logo { font-size: 1.8rem; font-weight: 700; color: var(--primary-color); }
        .nav-links { display: flex; align-items: center; list-style: none; gap: 25px; margin-left: auto; margin-right: 25px; }
        .nav-links a { font-weight: 500; transition: color 0.3s ease; }
        .nav-links a:hover, .nav-links .active { color: var(--primary-color); font-weight: 600; }
        .header-right { display: flex; align-items: center; gap: 15px; }
        .dark-mode-toggle { display: flex; align-items: center; gap: 8px; background-color: rgba(255,255,255,0.1); backdrop-filter: blur(10px); padding: 6px 12px; border-radius: 30px; box-shadow: var(--shadow); }
        .dark-mode-label { display: flex; align-items: center; gap: 6px; cursor: pointer; font-weight: 500; color: var(--text-color); font-size: 0.85rem; }
        .dark-mode-switch { position: relative; width: 34px; height: 18px; background-color: #ccc; border-radius: 34px; transition: background-color 0.3s; }
        .dark-mode-switch::after { content: ''; position: absolute; top: 2px; left: 2px; width: 14px; height: 14px; background-color: white; border-radius: 50%; transition: transform 0.3s; }
        #dark-mode-checkbox:checked + .dark-mode-switch { background-color: var(--primary-color); }
        #dark-mode-checkbox:checked + .dark-mode-switch::after { transform: translateX(16px); }
        #dark-mode-checkbox { display: none; }
        .hero { background: var(--hero-gradient); color: white; text-align: center; padding: 15px 0; }
        .hero h1 { font-size: 2.5rem; margin-bottom: 1.5rem; }
        .hero p { font-size: 1.2rem; max-width: 700px; margin: 0 auto 2rem; }
        .map-section { padding: 40px 0; }
        .map-container { display: grid; grid-template-columns: 1fr 2fr; gap: 30px; height: 600px; }
        .sidebar { background-color: var(--card-bg); border-radius: var(--radius); box-shadow: var(--shadow); padding: 25px; display: flex; flex-direction: column; overflow-y: auto; }
        .search-box { margin-bottom: 25px; }
        .search-box input { width: 100%; padding: 12px 15px; border: 1px solid var(--text-color); border-radius: 4px; font-size: 1rem; margin-bottom: 15px; background-color: var(--white); color: var(--text-color); }
        .search-actions { display: flex; gap: 10px; flex-wrap: wrap; }
        .search-actions .btn { flex: 1; min-width: 120px; padding: 12px 24px; }
        .sidebar h3 { color: var(--primary-dark); margin-bottom: 20px; font-size: 1.4rem; }
        .centers-list { flex-grow: 1; overflow-y: auto; }
        .center-card { background-color: var(--white); border-radius: var(--radius); padding: 20px; margin-bottom: 15px; cursor: pointer; transition: all 0.3s ease; border-left: 4px solid transparent; }
        .center-card:hover, .center-card.active { transform: translateY(-3px); box-shadow: var(--shadow); border-left-color: var(--primary-color); }
        .center-card.active { background-color: var(--light-bg); }
        .center-card h4 { color: var(--primary-dark); margin-bottom: 10px; font-size: 1.2rem; }
        .contact-details p { margin-bottom: 8px; display: flex; align-items: flex-start; gap: 8px; }
        .contact-details strong { min-width: 20px; }
        .map-wrapper { background-color: var(--card-bg); border-radius: var(--radius); box-shadow: var(--shadow); overflow: hidden; height: 100%; }
        #map { height: 100%; width: 100%; }
        .info-section { background-color: var(--white); }
        .section-title { text-align: center; margin-bottom: 3rem; }
        .section-title h2 { font-size: 2.2rem; color: var(--primary-dark); }
        .section-title p { color: var(--text-color); max-width: 600px; margin: 0 auto; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; }
        .info-card { background-color: var(--card-bg); border-radius: var(--radius); box-shadow: var(--shadow); padding: 30px; text-align: center; transition: transform 0.3s ease; }
        .info-card:hover { transform: translateY(-5px); }
        .info-icon { font-size: 3rem; color: var(--primary-color); margin-bottom: 20px; }
        .info-card h3 { color: var(--primary-dark); margin-bottom: 15px; }
        footer { background-color: var(--footer-bg); color: var(--footer-text); padding: 50px 0 20px; }
        .footer-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 30px; margin-bottom: 30px; }
        .footer-column h3 { font-size: 1.2rem; margin-bottom: 1.5rem; color: var(--primary-light); }
        .footer-links { list-style: none; }
        .footer-links li { margin-bottom: 10px; }
        .footer-links a { transition: color 0.3s ease; }
        .footer-links a:hover { color: var(--primary-light); }
        .copyright { text-align: center; padding-top: 20px; border-top: 1px solid #333; font-size: 0.9rem; color: #aaa; }
        @media (max-width: 1024px) {
            .nav-links { gap: 20px; margin-right: 20px; }
            .header-right { gap: 12px; }
        }
        @media (max-width: 768px) {
            .header-container { flex-direction: column; gap: 15px; }
            .nav-links { margin: 10px auto; gap: 15px; flex-wrap: wrap; justify-content: center; margin-right: 0; }
            .header-right { order: 1; width: 100%; justify-content: center; margin-top: 10px; }
            .hero h1 { font-size: 2rem; }
            .map-container { grid-template-columns: 1fr; height: auto; }
            .map-wrapper { height: 400px; }
            .search-actions { flex-direction: column; }
            .search-actions .btn { width: 100%; }
            .dark-mode-toggle { padding: 6px 12px; }
            .dark-mode-label span { display: none; }
        }
        @media (max-width: 480px) {
            .hero h1 { font-size: 1.8rem; }
            .section-title h2 { font-size: 1.8rem; }
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-container">
            <a href="index.html" class="logo">DropMyElectronic</a>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="reward.html">Rewards</a></li>
                <li><a href="quiz.html">Quiz</a></li>
                <li><a href="support.html">Support</a></li>
            </ul>
            <div class="header-right">
                <a href="sign.html" class="btn">Start now</a>
                <div class="dark-mode-toggle">
                    <label for="dark-mode-checkbox" class="dark-mode-label">
                        <i class="fas fa-moon"></i><span>Dark Mode</span>
                        <input type="checkbox" id="dark-mode-checkbox">
                        <div class="dark-mode-switch"></div>
                    </label>
                </div>
            </div>
        </div>
    </header>
    <section class="hero">
        <div class="container">
            <h1>Global Recycling Centers</h1>
            <p>Find certified e-waste recycling facilities near you. Locate drop-off points and learn about proper disposal methods.</p>
        </div>
    </section>
    <section class="map-section">
        <div class="container">
            <div class="map-container">
                <div class="sidebar">
                    <div class="search-box">
                        <input type="text" id="locationSearch" placeholder="Search for any city or area...">
                        <div class="search-actions">
                            <button class="btn" onclick="searchLocation()">Search Area</button>
                            <button class="btn btn-secondary" onclick="useCurrentLocation()">My Location</button>
                        </div>
                    </div>
                    <h3><i class="fas fa-map-marker-alt"></i> Recycling Centers</h3>
                    <div class="centers-list" id="centerList"></div>
                </div>
                <div class="map-wrapper">
                    <div id="map"></div>
                </div>
            </div>
        </div>
    </section>
    <section class="info-section">
        <div class="container">
            <div class="section-title">
                <h2>How to Use Our Map</h2>
                <p>Find the best recycling options for your e-waste</p>
            </div>
            <div class="info-grid">
                <div class="info-card">
                    <div class="info-icon"><i class="fas fa-search-location"></i></div>
                    <h3>Search Locations</h3>
                    <p>Use the search box to find recycling centers anywhere in the world or use your current location.</p>
                </div>
                <div class="info-card">
                    <div class="info-icon"><i class="fas fa-info-circle"></i></div>
                    <h3>View Details</h3>
                    <p>Click on any recycling center to see operating hours, accepted items, and contact information.</p>
                </div>
                <div class="info-card">
                    <div class="info-icon"><i class="fas fa-route"></i></div>
                    <h3>Plan Your Visit</h3>
                    <p>Check the center details to ensure they accept your specific e-waste items before visiting.</p>
                </div>
            </div>
        </div>
    </section>
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>DropMyElectronic</h3>
                    <p>Making e-waste recycling simple and accessible for everyone.</p>
                </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="about.html">About</a></li>
                        <li><a href="reward.html">Rewards</a></li>
                        <li><a href="support.html">Support</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Resources</h3>
                    <ul class="footer-links">
                        <li><a href="#">FAQ</a></li>
                        <li><a href="#">Support</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Contact</h3>
                    <ul class="footer-links">
                        <li><a href="mailto:info@dropmyelectronic.com">Email</a></li>
                        <li><a href="#">Twitter</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 DropMyElectronic. All rights reserved. | Made with ❤️ for a sustainable future</p>
            </div>
        </div>
    </footer>
    <script>
        // Note: Replace 'YOUR_GOOGLE_MAPS_API_KEY' with your actual Google Maps API key
        const GOOGLE_MAPS_API_KEY = 'YOUR_GOOGLE_MAPS_API_KEY';
        
        const recyclingCenters = [
            {id: 1, name: "WEEE Centre - Nairobi", lat: -1.278398296907602, lng: 36.952653695036254, address: "Mihango, Embakasi, Off the Eastern By-pass", phone: "0701819559", hours: "Mon-Fri: 8AM-5PM\nSat: 9AM-1PM\nSun: Closed", accepts: "Computers, phones, TVs, printers, batteries"},
            {id: 2, name: "Safaricom E-Waste Drop-off", lat: -1.2733, lng: 36.8067, address: "Safaricom House, Westlands, Nairobi", phone: "0722000000", hours: "Mon-Fri: 8AM-5PM", accepts: "Mobile phones, tablets, accessories, batteries"},
            {id: 3, name: "Eco Create & Innovate - ECANDI", lat: -1.2156578760311965, lng: 36.797297222022095, address: "32824, Limuru Rd, Nairobi", phone: "0741777986", hours: "Mon-Fri: 9AM-6PM \n Sat: 9AM-4PM \n Sun: Closed", accepts: "All electronics, appliances, batteries"},
            {id: 4, name: "GreenTech Solutions", lat: -1.2762636825707399, lng: 36.8267353691281, address: "Next to Nyayo Market, Ngara, Nairobi.", phone: "0722969219", hours: "Mon-Sat: 9AM-5PM\nSun: Closed", accepts: "Phones, laptops, small electronics"}
        ];

        let map, userMarker, recyclingMarkers = [], activeCenterId = null;
        let googleMapsLoaded = false;

        // Load Google Maps API dynamically
        function loadGoogleMapsAPI() {
            return new Promise((resolve, reject) => {
                if (window.google && window.google.maps) {
                    googleMapsLoaded = true;
                    resolve();
                    return;
                }
                
                const script = document.createElement('script');
                script.src = `https://maps.googleapis.com/maps/api/js?key=${GOOGLE_MAPS_API_KEY}&callback=initMap`;
                script.async = true;
                script.defer = true;
                
                window.initMap = function() {
                    googleMapsLoaded = true;
                    resolve();
                };
                
                script.onerror = reject;
                document.head.appendChild(script);
            });
        }

        function initMap() {
            // Default to Nairobi as initial view, but allow global navigation
            const defaultLocation = { lat: -1.286389, lng: 36.817223 };
            
            map = new google.maps.Map(document.getElementById('map'), {
                center: defaultLocation,
                zoom: 11,
                mapTypeControl: true,
                streetViewControl: true,
                fullscreenControl: true,
                zoomControl: true,
                styles: [
                    {
                        featureType: "all",
                        elementType: "labels.text.fill",
                        stylers: [{ color: "#333333" }]
                    }
                ]
            });

            // Apply dark mode if needed
            applyMapTheme();
            addRecyclingCenters();
            updateCenterList();
        }

        function applyMapTheme() {
            if (document.body.classList.contains('dark-mode')) {
                map.setOptions({
                    styles: [
                        { elementType: "geometry", stylers: [{ color: "#242f3e" }] },
                        { elementType: "labels.text.stroke", stylers: [{ color: "#242f3e" }] },
                        { elementType: "labels.text.fill", stylers: [{ color: "#746855" }] },
                        {
                            featureType: "administrative.locality",
                            elementType: "labels.text.fill",
                            stylers: [{ color: "#d59563" }]
                        },
                        {
                            featureType: "poi",
                            elementType: "labels.text.fill",
                            stylers: [{ color: "#d59563" }]
                        },
                        {
                            featureType: "poi.park",
                            elementType: "geometry",
                            stylers: [{ color: "#263c3f" }]
                        },
                        {
                            featureType: "poi.park",
                            elementType: "labels.text.fill",
                            stylers: [{ color: "#6b9a76" }]
                        },
                        {
                            featureType: "road",
                            elementType: "geometry",
                            stylers: [{ color: "#38414e" }]
                        },
                        {
                            featureType: "road",
                            elementType: "geometry.stroke",
                            stylers: [{ color: "#212a37" }]
                        },
                        {
                            featureType: "road",
                            elementType: "labels.text.fill",
                            stylers: [{ color: "#9ca5b3" }]
                        },
                        {
                            featureType: "road.highway",
                            elementType: "geometry",
                            stylers: [{ color: "#746855" }]
                        },
                        {
                            featureType: "road.highway",
                            elementType: "geometry.stroke",
                            stylers: [{ color: "#1f2835" }]
                        },
                        {
                            featureType: "road.highway",
                            elementType: "labels.text.fill",
                            stylers: [{ color: "#f3d19c" }]
                        },
                        {
                            featureType: "transit",
                            elementType: "geometry",
                            stylers: [{ color: "#2f3948" }]
                        },
                        {
                            featureType: "transit.station",
                            elementType: "labels.text.fill",
                            stylers: [{ color: "#d59563" }]
                        },
                        {
                            featureType: "water",
                            elementType: "geometry",
                            stylers: [{ color: "#17263c" }]
                        },
                        {
                            featureType: "water",
                            elementType: "labels.text.fill",
                            stylers: [{ color: "#515c6d" }]
                        },
                        {
                            featureType: "water",
                            elementType: "labels.text.stroke",
                            stylers: [{ color: "#17263c" }]
                        }
                    ]
                });
            }
        }

        function addRecyclingCenters() {
            recyclingCenters.forEach(center => {
                const marker = new google.maps.Marker({
                    position: { lat: center.lat, lng: center.lng },
                    map: map,
                    title: center.name,
                    icon: {
                        path: google.maps.SymbolPath.CIRCLE,
                        fillColor: '#2e7d32',
                        fillOpacity: 1,
                        strokeColor: '#ffffff',
                        strokeWeight: 2,
                        scale: 10
                    },
                    animation: google.maps.Animation.DROP
                });

                const infoWindow = new google.maps.InfoWindow({
                    content: `
                        <div style="min-width: 250px; font-family: 'Segoe UI', sans-serif;">
                            <h4 style="margin: 0 0 10px 0; color: #1b5e20;">${center.name}</h4>
                            <p style="margin: 5px 0;"><strong><i class="fas fa-phone"></i> Phone:</strong> ${center.phone}</p>
                            <p style="margin: 5px 0;"><strong><i class="fas fa-map-marker-alt"></i> Address:</strong> ${center.address}</p>
                            <p style="margin: 5px 0;"><strong><i class="fas fa-clock"></i> Hours:</strong> ${center.hours.replace(/\n/g, '<br>')}</p>
                            <p style="margin: 5px 0;"><strong><i class="fas fa-check-circle"></i> Accepts:</strong> ${center.accepts}</p>
                            <button onclick="focusOnCenter(${center.id})" style="width: 100%; padding: 10px; margin-top: 10px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">View Details</button>
                        </div>
                    `
                });

                marker.addListener('click', () => {
                    infoWindow.open(map, marker);
                    setActiveCenter(center.id);
                });

                recyclingMarkers.push({
                    marker: marker,
                    infoWindow: infoWindow,
                    centerId: center.id
                });
            });
        }

        function updateCenterList() {
            const centerList = document.getElementById('centerList');
            centerList.innerHTML = '';
            recyclingCenters.forEach((center, index) => {
                const card = document.createElement('div');
                card.className = 'center-card';
                card.style.animationDelay = `${index * 0.1}s`;
                card.innerHTML = `<h4>${center.name}</h4><div class="contact-details">
                    <p><strong><i class="fas fa-map-marker-alt"></i></strong> ${center.address}</p>
                    <p><strong><i class="fas fa-phone"></i></strong> ${center.phone}</p>
                    <p><strong><i class="fas fa-clock"></i></strong> ${center.hours.replace(/\n/g, '<br>')}</p>
                    <p><strong><i class="fas fa-check-circle"></i></strong> ${center.accepts}</p></div>`;
                card.addEventListener('click', () => { 
                    focusOnCenter(center.id); 
                    setActiveCenter(center.id); 
                });
                centerList.appendChild(card);
            });
        }

        function setActiveCenter(centerId) {
            document.querySelectorAll('.center-card').forEach(card => card.classList.remove('active'));
            const cards = document.querySelectorAll('.center-card');
            const centerIndex = recyclingCenters.findIndex(c => c.id === centerId);
            if (centerIndex !== -1 && cards[centerIndex]) {
                cards[centerIndex].classList.add('active');
                cards[centerIndex].scrollIntoView({behavior: 'smooth', block: 'nearest'});
            }
            activeCenterId = centerId;
            
            // Also highlight the marker on the map
            recyclingMarkers.forEach(markerObj => {
                if (markerObj.centerId === centerId) {
                    markerObj.infoWindow.open(map, markerObj.marker);
                }
            });
        }

        function focusOnCenter(centerId) {
            const center = recyclingCenters.find(c => c.id === centerId);
            if (center) {
                map.setCenter({ lat: center.lat, lng: center.lng });
                map.setZoom(15);
            }
        }

        function searchLocation() {
            const searchText = document.getElementById('locationSearch').value.trim();
            if (!searchText) { 
                alert('Please enter a location to search.'); 
                return; 
            }
            
            const geocoder = new google.maps.Geocoder();
            geocoder.geocode({ address: searchText }, function(results, status) {
                if (status === 'OK' && results[0]) {
                    map.setCenter(results[0].geometry.location);
                    map.setZoom(14);
                    document.getElementById('locationSearch').value = '';
                } else {
                    alert('Location not found. Please try a different search term.');
                }
            });
        }

        function useCurrentLocation() {
            if (!navigator.geolocation) { 
                alert('Geolocation not supported.'); 
                return; 
            }
            
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'Locating...';
            button.disabled = true;
            
            navigator.geolocation.getCurrentPosition(
                position => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;
                    const location = { lat, lng };
                    
                    map.setCenter(location);
                    map.setZoom(14);
                    
                    if (userMarker) {
                        userMarker.setPosition(location);
                    } else {
                        userMarker = new google.maps.Marker({
                            position: location,
                            map: map,
                            title: 'Your Current Location',
                            icon: {
                                path: google.maps.SymbolPath.CIRCLE,
                                fillColor: '#ff9800',
                                fillOpacity: 1,
                                strokeColor: '#ffffff',
                                strokeWeight: 2,
                                scale: 10
                            }
                        });
                        
                        const infoWindow = new google.maps.InfoWindow({
                            content: '<div style="padding: 10px;"><strong>Your Current Location</strong></div>'
                        });
                        infoWindow.open(map, userMarker);
                    }
                    
                    button.textContent = 'Location Found!';
                    setTimeout(() => { 
                        button.textContent = originalText; 
                        button.disabled = false; 
                    }, 2000);
                },
                error => {
                    alert('Unable to get location. Please enable location services or search manually.');
                    button.textContent = originalText;
                    button.disabled = false;
                },
                { enableHighAccuracy: true, timeout: 10000, maximumAge: 60000 }
            );
        }

        // Initialize when the page loads
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                await loadGoogleMapsAPI();
                if (googleMapsLoaded) {
                    initMap();
                }
            } catch (error) {
                console.error('Error loading Google Maps:', error);
                document.getElementById('map').innerHTML = `
                    <div style="display: flex; justify-content: center; align-items: center; height: 100%; color: var(--text-color);">
                        <div style="text-align: center;">
                            <h3>Unable to load map</h3>
                            <p>Please check your Google Maps API key and try again.</p>
                        </div>
                    </div>
                `;
            }

            // Initialize dark mode functionality
            initDarkMode();
        });

        function initDarkMode() {
            const darkModeToggle = document.getElementById('dark-mode-checkbox');
            const body = document.body;
            const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
            const currentTheme = localStorage.getItem('theme');
            
            function updateDarkModeIcon(isDark) {
                const icon = document.querySelector('.dark-mode-label i');
                const label = document.querySelector('.dark-mode-label span');
                icon.className = isDark ? 'fas fa-sun' : 'fas fa-moon';
                label.textContent = isDark ? 'Light Mode' : 'Dark Mode';
            }
            
            if (currentTheme === 'dark' || (!currentTheme && prefersDarkScheme.matches)) {
                body.classList.add('dark-mode');
                darkModeToggle.checked = true;
                updateDarkModeIcon(true);
                applyMapTheme();
            }
            
            darkModeToggle.addEventListener('change', function() {
                if (this.checked) {
                    body.classList.add('dark-mode');
                    localStorage.setItem('theme', 'dark');
                    updateDarkModeIcon(true);
                } else {
                    body.classList.remove('dark-mode');
                    localStorage.setItem('theme', 'light');
                    updateDarkModeIcon(false);
                }
                applyMapTheme();
            });
            
            prefersDarkScheme.addEventListener('change', function(e) {
                if (!localStorage.getItem('theme')) {
                    if (e.matches) {
                        body.classList.add('dark-mode');
                        darkModeToggle.checked = true;
                        updateDarkModeIcon(true);
                    } else {
                        body.classList.remove('dark-mode');
                        darkModeToggle.checked = false;
                        updateDarkModeIcon(false);
                    }
                    applyMapTheme();
                }
            });
        }
    </script>
</body>
</html>